<html>
  <head>
    <title>Dataset entry form</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script> 
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script> 

    <style>
      label.error {
        padding-left: 10px;
        color: #F00;
      }
      #name, #description, #spreadsheet {
        width: 521px;
      }
      form td {
        padding-bottom: 5px;
      }
      
      table .feature_types, table .group, table .author {    
        margin-left: 10px;
      }
      table .feature_types td {
        vertical-align: text-top;
        height: 80px;
      }
      
      table .fragment {
        margin-left: 20px;
        display: inline;
      }
      
      table.fragment td {
        height: auto;
      }
      
      td.additional {
        font-style: italic;
      }
    </style>

  </head>
  <body>
    <h2>Dataset entry form</h2>
    
    <form accept-charset="UTF-8" action="http://<%= request.host %>:3000/items/create" enctype="multipart/form-data" method="post">
      <input type="hidden" name="owner[user_id]" id="user_id" value="<%= logged_in? ? current_user.id : 0 %>" />
      <table>
        <tr>
          <td><label for="name">Title</label></td><td><input id="name" name="dataset[name]" type="text" /></td>
        </tr>
        <tr>
          <td><label for="description">Description</label></td><td><textarea id="description" name="dataset[description]"></textarea></td>
        </tr>
        <tr>
          <td><label for="source">Source</label></td><td><input id="source" name="dataset[source]" type="text" /></td>
        </tr>
        <tr>
          <td style="width: 300px;"><label for="file">Upload file</label></td><td><input id="spreadsheet" name="filename" type="file" /></td>
        </tr>
        <tr>
          <td colspan="2" class="additional">Valid uploads include: <strong>Spreadsheets</strong> in .cvs, .ods, .xls, or .xlsx format, or <strong>Shape</strong> files (a .zip file) containing at least a .shp and .dbf file.</td>
        </tr>    
        <tr>
          <td colspan="2"><b>Feature type</b>
            <table class="feature_types">
          <% feature_types = [{:description => 'Non-temporal (static)', :id => 3, :name => 'observation_data_static'}, {:description => 'Temporal (dynamic)', :id => 4, :name => 'observation_data_dynamic'}] %>
          <% feature_types.each_with_index do |item| %>
            <%= "<tr><td><label for=\"feature_type_#{item[:name]}\">#{item[:description]}</label></td><td>".html_safe -%>
              <%= radio_button_tag 'dataset[feature_type]', item[:name], false -%>
              <% if item[:id] == 3 %>
                <%= render 'static_observation' %>
              <% else %>
                <%= render 'dynamic_observation' %>
              <% end %>
            <%= "</td></tr>".html_safe %>
          <% end %>
            </table>
          </td>
        </tr>
        <tr>
          <td colspan="2"><b>Author</b> (optional)
            <table class="author">
              <tr>
                <td><label for="author_name">Name</label></td><td><input id="author_name" name="author[name]" /></td>
              </tr>
              <tr>
                <td><label for="author_email">Email</label></td><td><input id="author_email" name="author[email]" /></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td><input name="upload" type="submit" value="Upload" /></td>
        </tr>
      </table>      
    </form>
  </body>
</html>
